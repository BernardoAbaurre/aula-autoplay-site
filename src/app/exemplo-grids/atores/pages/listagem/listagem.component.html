<div class="container mt-4">
  <h1 class="mb-4">Listagem de Atores</h1>

  <!-- Accordion de Filtros -->
  <div class="accordion mb-4" id="accordionFiltros">
    <div class="accordion-item">
      <h2 class="accordion-header" id="headingFiltros">
        <button
          class="accordion-button collapsed"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#collapseFiltros"
          aria-expanded="false"
          aria-controls="collapseFiltros">
          <i class="bi bi-funnel me-2"></i>
          Filtros de Pesquisa
        </button>
      </h2>
      <div
        id="collapseFiltros"
        class="accordion-collapse collapse"
        aria-labelledby="headingFiltros"
        data-bs-parent="#accordionFiltros">
        <div class="accordion-body">
          <form [formGroup]="filtroForm" (ngSubmit)="filtrar()">
            <div class="row g-3">
          <!-- ID -->
          <div class="col-md-2">
            <label for="id" class="form-label">ID</label>
            <input
              type="number"
              class="form-control"
              id="id"
              formControlName="Id"
              placeholder="ID">
          </div>

          <!-- Nome -->
          <div class="col-md-5">
            <label for="nome" class="form-label">Nome</label>
            <input
              type="text"
              class="form-control"
              id="nome"
              formControlName="Nome"
              placeholder="Nome do ator">
          </div>

          <!-- Sobrenome -->
          <div class="col-md-5">
            <label for="sobrenome" class="form-label">Sobrenome</label>
            <input
              type="text"
              class="form-control"
              id="sobrenome"
              formControlName="Sobrenome"
              placeholder="Sobrenome do ator">
          </div>

          <!-- Data Nascimento Início -->
          <div class="col-md-3">
            <label for="dataNascimentoInicio" class="form-label">Data Nascimento (De)</label>
            <input
              type="date"
              class="form-control"
              id="dataNascimentoInicio"
              formControlName="DataNascimentoInicio">
          </div>

          <!-- Data Nascimento Fim -->
          <div class="col-md-3">
            <label for="dataNascimentoFim" class="form-label">Data Nascimento (Até)</label>
            <input
              type="date"
              class="form-control"
              id="dataNascimentoFim"
              formControlName="DataNascimentoFim">
          </div>

          <!-- Data Falecimento Início -->
          <div class="col-md-3">
            <label for="dataFalecimentoInicio" class="form-label">Data Falecimento (De)</label>
            <input
              type="date"
              class="form-control"
              id="dataFalecimentoInicio"
              formControlName="DataFalecimentoInicio">
          </div>

          <!-- Data Falecimento Fim -->
          <div class="col-md-3">
            <label for="dataFalecimentoFim" class="form-label">Data Falecimento (Até)</label>
            <input
              type="date"
              class="form-control"
              id="dataFalecimentoFim"
              formControlName="DataFalecimentoFim">
          </div>

          <!-- Altura Mínima -->
          <div class="col-md-3">
            <label for="alturaMinima" class="form-label">Altura Mínima (m)</label>
            <input
              type="number"
              step="0.01"
              class="form-control"
              id="alturaMinima"
              formControlName="AlturaMinima"
              placeholder="Ex: 1.65">
          </div>

          <!-- Altura Máxima -->
          <div class="col-md-3">
            <label for="alturaMaxima" class="form-label">Altura Máxima (m)</label>
            <input
              type="number"
              step="0.01"
              class="form-control"
              id="alturaMaxima"
              formControlName="AlturaMaxima"
              placeholder="Ex: 1.90">
          </div>
        </div>

        <!-- Botões -->
        <div class="row mt-3">
          <div class="col-12">
            <button type="submit" class="btn btn-primary me-2">
              <i class="bi bi-search"></i> Filtrar
            </button>
            <button type="button" class="btn btn-secondary" (click)="limparFiltros()">
              <i class="bi bi-x-circle"></i> Limpar Filtros
            </button>
          </div>
        </div>
      </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading -->
  <div *ngIf="carregando" class="text-center my-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Carregando...</span>
    </div>
  </div>

  <!-- Erro -->
  <div *ngIf="erro" class="alert alert-danger" role="alert">
    {{ erro }}
  </div>

  <!-- Tabela de Atores -->
  <div *ngIf="!carregando && !erro" class="table-responsive">
    <table class="table table-striped table-hover">
      <thead class="table-dark">
        <tr>
          <th scope="col" class="cursor-pointer" (click)="ordenar('Id')">
            ID <i class="bi" [ngClass]="getIconeOrdenacao('Id')"></i>
          </th>
          <th scope="col" class="cursor-pointer" (click)="ordenar('Nome')">
            Nome <i class="bi" [ngClass]="getIconeOrdenacao('Nome')"></i>
          </th>
          <th scope="col" class="cursor-pointer" (click)="ordenar('Sobrenome')">
            Sobrenome <i class="bi" [ngClass]="getIconeOrdenacao('Sobrenome')"></i>
          </th>
          <th scope="col" class="cursor-pointer" (click)="ordenar('DataNascimento')">
            Data Nascimento <i class="bi" [ngClass]="getIconeOrdenacao('DataNascimento')"></i>
          </th>
          <th scope="col" class="cursor-pointer" (click)="ordenar('DataFalecimento')">
            Data Falecimento <i class="bi" [ngClass]="getIconeOrdenacao('DataFalecimento')"></i>
          </th>
          <th scope="col" class="cursor-pointer" (click)="ordenar('Altura')">
            Altura (m) <i class="bi" [ngClass]="getIconeOrdenacao('Altura')"></i>
          </th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let ator of atores">
          <th scope="row">{{ ator.Id }}</th>
          <td>{{ ator.Nome }}</td>
          <td>{{ ator.Sobrenome }}</td>
          <td>{{ ator.DataNascimento | date:'dd/MM/yyyy' }}</td>
          <td>
            <span *ngIf="ator.DataFalecimento">{{ ator.DataFalecimento | date:'dd/MM/yyyy' }}</span>
            <span *ngIf="!ator.DataFalecimento" class="text-muted">-</span>
          </td>
          <td>{{ ator.Altura | number:'1.2-2' }}</td>
        </tr>
      </tbody>
    </table>

    <!-- Mensagem quando não há resultados -->
    <div *ngIf="atores.length === 0" class="alert alert-info text-center">
      Nenhum ator encontrado.
    </div>
  </div>
</div>
